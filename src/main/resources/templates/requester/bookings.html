<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>View Bookings</title>
</head>
<body>
	<div th:insert="~{fragments/navbar :: body}"></div>

	<h2>Your/Requester Bookings</h2>

	<table border="1">
		<thead>
			<tr>
				<th>Worker</th>
				<th>Skill</th>
				<th>Start Time</th>
				<th>End Time</th>
				<th>Status</th>
				<th>View Report</th>
				<th>Feedback</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="booking : ${bookings}">
				<td
					th:text="${booking.worker != null ? booking.worker.name : 'N/A'}"></td>
				<td
					th:text="${booking.skillListing != null ? booking.skillListing.skillName : 'N/A'}"></td>
				<td
					th:text="${#temporals.format(booking.startTime, 'yyyy-MM-dd HH:mm')}"></td>
				<td
					th:text="${#temporals.format(booking.endTime, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${booking.status}"></td>

				<!-- View inspection Report Link -->
				<td><a
					th:href="@{/inspection/view/{bookingId}(bookingId=${booking.id})}">
						View Report </a></td>

				<!-- Feedback Report Link (Only if booking is COMPLETED) -->
				<td><span
					th:if="${feedbackService.getFeedbackByBookingId(booking.id).isPresent()}">
						<a
						th:href="@{/feedback/view/{bookingId}(bookingId=${booking.id})}">View
							Feedback</a>
				</span></td>

			</tr>
		</tbody>
	</table>

	<p th:if="${#lists.isEmpty(bookings)}">No bookings available.</p>
</body>
</html>
